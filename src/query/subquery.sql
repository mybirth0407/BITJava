-- 1select count(*) as '현재 평균 연봉보다 많은 월급을 받는 직원의 수'from salaries swhere s.salary > (    select avg(s.salary)    from salaries s    where s.to_date = '9999-01-01')    and s.to_date = '9999-01-01';-- 2select e.emp_no as '사번', concat(e.first_name, ' ', e.last_name) as '이름',    d.dept_name as '부서', s.salary as '연봉'from salaries s, dept_emp de, employees e, departments d, (    select max(s.salary) as 'table_max_salary'    from salaries s, dept_emp de    where s.emp_no = de.emp_no        and de.to_date = '9999-01-01'        and s.to_date = '9999-01-01'    group by de.dept_no    ) max_salarywhere e.emp_no = s.emp_no    and e.emp_no = de.emp_no    and d.dept_no = de.dept_no    and s.salary = max_salary.table_max_salary    and s.to_date = '9999-01-01'    and de.to_date = '9999-01-01'order by s.salary desc;-- 3select e.emp_no as '사번', concat(first_name, ' ', last_name) as '이름',    s.salary as '연봉'from employees e, dept_emp de, salaries s, (    select de.dept_no, avg(s.salary) as avg_salary    from employees e, dept_emp de, salaries s    where e.emp_no = de.emp_no        and e.emp_no = s.emp_no        and de.to_date = '9999-01-01'        and s.to_date = '9999-01-01'    group by de.dept_no) sub_avgsalwhere e.emp_no = de.emp_no    and e.emp_no = s.emp_no    and de.dept_no = sub_avgsal.dept_no    and de.to_date = '9999-01-01'    and s.to_date = '9999-01-01'    and s.salary > sub_avgsal.avg_salary;-- 4-- 5    -- 6select d.dept_name as '평균 연봉이 가장 높은 부서',    avg(s.salary) as '평균 연봉'from dept_emp de, salaries s, departments dwhere de.emp_no = s.emp_no    and de.dept_no = d.dept_nogroup by de.dept_noorder by avg(s.salary) desc;-- 7select t.title as '평균 연봉이 가장 높은 직책', avg(s.salary) as '평균 연봉'from titles t, salaries swhere t.emp_no = s.emp_nogroup by t.titleorder by avg(s.salary) desc;--문제1SELECT COUNT(*)  FROM employees a, salaries b WHERE     a.emp_no = b.emp_no       AND b.to_date = '9999-1-1'       AND b.salary > (SELECT AVG(salary)                         FROM employees a, salaries b                        WHERE a.emp_no = b.emp_no AND b.to_date = '9999-1-1');--문제2  SELECT a.emp_no,         concat(a.first_name, ' ', a.last_name) AS name,         c.dept_name,         d.max_salary    FROM employees a,         dept_emp b,         salaries e,         departments c,         (  SELECT b.dept_no, max(c.salary) AS max_salary              FROM employees a, dept_emp b, salaries c             WHERE     a.emp_no = b.emp_no                   AND a.emp_no = c.emp_no                   AND b.to_date = '9999-1-1'                   AND c.to_date = '9999-1-1'          GROUP BY b.dept_no) d   WHERE    a.emp_no = b.emp_no         AND b.dept_no = c.dept_no         AND c.dept_no = d.dept_no         AND a.emp_no = e.emp_no         AND e.salary = d.max_salary         AND b.to_date = '9999-1-1'         AND e.to_date = '9999-1-1'ORDER BY d.max_salary DESC;--문제3SELECT a.emp_no, concat(first_name, ' ', last_name) AS name, c.salary  FROM employees a,       dept_emp b,       salaries c,       (  SELECT b.dept_no, avg(c.salary) AS avg_salary            FROM employees a, dept_emp b, salaries c           WHERE     a.emp_no = b.emp_no                 AND a.emp_no = c.emp_no                 AND b.to_date = '9999-1-1'                 AND c.to_date = '9999-1-1'        GROUP BY b.dept_no) d WHERE     a.emp_no = b.emp_no       AND a.emp_no = c.emp_no       AND b.dept_no = d.dept_no       AND b.to_date = '9999-1-1'       AND c.to_date = '9999-1-1'       AND c.salary > d.avg_salary;--문제4SELECT a.emp_no,       CONCAT(first_name, ' ', last_name) AS name,       c.dept_name,       d.manager_name  FROM employees a,       dept_emp b,       departments c,       (SELECT b.dept_no,               CONCAT(a.first_name, ' ', a.last_name) AS manager_name          FROM employees a, dept_manager b, departments c         WHERE     a.emp_no = b.emp_no               AND b.dept_no = c.dept_no               AND b.to_date = '9999-1-1') d WHERE     a.emp_no = b.emp_no       AND b.dept_no = c.dept_no       AND c.dept_no = d.dept_no       AND b.to_date = '9999-1-1';-- 문제5 XSELECT a.emp_no, CONCAT(first_name, ' ', last_name) AS name, c.title, d.salary  FROM employees a,       dept_emp b,       titles c,       salaries d,       ( SELECT dept_no, MAX( avg_salary )           FROM (  SELECT b.dept_no, ROUND( AVG( d.salary ) ) AS avg_salary                     FROM employees a,                          dept_emp b,                          departments c,                          salaries d                    WHERE a.emp_no = b.emp_no                      AND b.dept_no = c.dept_no                      AND a.emp_no = d.emp_no                      AND b.to_date = '9999-1-1'                      AND d.to_date = '9999-1-1'                 GROUP BY b.dept_no ) k ) eWHERE a.emp_no = b.emp_no  AND a.emp_no = c.emp_no  AND a.emp_no = d.emp_no  AND b.dept_no = e.dept_no  AND b.to_date = '9999-1-1'  AND c.to_date = '9999-1-1'  AND d.to_date = '9999-1-1';                                              -- 문제6  SELECT c.dept_name, ROUND( AVG( d.salary ) )    FROM employees a,         dept_emp b,         departments c,         salaries d   WHERE a.emp_no = b.emp_no     AND b.dept_no = c.dept_no     AND a.emp_no = d.emp_no     AND b.to_date = '9999-1-1'     AND d.to_date = '9999-1-1' GROUP BY c.dept_name  HAVING ROUND( AVG( d.salary ) ) = ( SELECT MAX( avg_salary )                                        FROM (  SELECT ROUND( AVG( d.salary ) ) AS avg_salary                                                  FROM employees a,                                                       dept_emp b,                                                       departments c,                                                       salaries d                                                 WHERE a.emp_no = b.emp_no                                                   AND b.dept_no = c.dept_no                                                   AND a.emp_no = d.emp_no                                                   AND b.to_date = '9999-1-1'                                                   AND d.to_date = '9999-1-1'                                              GROUP BY b.dept_no ) k );    -- 문제7  SELECT b.title, ROUND( AVG( c.salary ) )    FROM employees a,         titles b,           salaries c   WHERE a.emp_no = b.emp_no     AND a.emp_no = c.emp_no     AND b.to_date = '9999-1-1'     AND c.to_date = '9999-1-1' GROUP BY b.title  HAVING ROUND( AVG( c.salary ) ) = ( SELECT MAX( avg_salary )                                        FROM (  SELECT ROUND( AVG( c.salary ) ) AS avg_salary                                                  FROM employees a,                                                       titles b,                                                       salaries c                                                 WHERE a.emp_no = b.emp_no                                                   AND a.emp_no = c.emp_no                                                   AND b.to_date = '9999-1-1'                                                   AND c.to_date = '9999-1-1'                                              GROUP BY b.title ) k );                                                                                            --문제8SELECT d.dept_name, CONCAT( first_name, ' ', last_name ) AS name, c.salary, m.name, m.salary  FROM employees a,       dept_emp b,       salaries c,       departments d,       ( SELECT b.dept_no, CONCAT( first_name, ' ', last_name ) AS name, c.salary           FROM employees a,                dept_manager b,                salaries c          WHERE a.emp_no = b.emp_no            AND a.emp_no = c.emp_no            AND b.to_date = '9999-1-1'            AND c.to_date = '9999-1-1' ) m      WHERE a.emp_no = b.emp_no   AND a.emp_no = c.emp_no   AND b.dept_no = d.dept_no   AND b.to_date = '9999-1-1'   AND c.to_date = '9999-1-1'         AND b.dept_no = m.dept_no   AND c.salary > m.salary;    